# CA2 Part 2 Ant - Alternative solution with Ant üõ†Ô∏è 

This project is a simple Spring Boot application built with Ant and Ivy for dependency management. It uses React for the frontend and H2 as an in-memory database.

## Prerequisites

- Java 8 or higher
- Ant
- Ivy
- Node.js and npm

## Instructions

1. Create a new branch called tut-basic-maven using the following command:
   ```bash
   git checkout -b tut-basic-maven
   ```

1.1 Refer to the provided image for guidance.  

![image example](https://github.com/marianafpereira/DevOps-23-24-JPE-1231845/wiki/Project-Images-For-CA2-Part2#step-1)

2. Navigate to https://start.spring.io to initiate a new Spring Boot project with Ant. The project should include the following dependencies: Rest Repositories, Thymeleaf, JPA, and H2.  

2.1 Refer to the provided image for guidance.  

![image example](https://github.com/marianafpereira/DevOps-23-24-JPE-1231845/wiki/Project-Images-For-CA2-Part2#step-2)

3. Unzip the downloaded project file into the "CA2/Part2_ant/" directory of your repository. This gives you a basic Spring application that can be built using Maven.

4. Remove the existing src directory. We aim to use the code from the basic tutorial instead.  

5. Copy the src directory (including all its subdirectories) from the basic tutorial folder to this new folder.  

Also, copy the *webpack.config.js* and *package.json* files.  

6. Delete the src/main/resources/static/built/ directory as it should be generated by the webpack tool from the JavaScript code. 8.1 Refer to the provided image for guidance.  


*IMPORTANT NOTE* 

Modify the imports in *Employee.java* from *javax* to *jakarta*. 

1.1 Refer to the provided image for guidance.  

![image example](https://github.com/marianafpereira/DevOps-23-24-JPE-1231845/wiki/Project-Images-For-CA2-Part2#step-13) 

Insert "packageManager": ```"npm@9.6.7"``` into the package.json file. 

1.1 Refer to the provided image for guidance.  

![image example](https://github.com/marianafpereira/DevOps-23-24-JPE-1231845/wiki/Project-Images-For-CA2-Part2#step-11)

2. Add the necessary Ant tasks to the build.xml file to handle the frontend build. This might involve running npm scripts or other commands

```xml
<target name="init-frontend">
    <exec executable="npm" dir="src/main/frontend">
        <arg value="install"/>
    </exec>
</target>

<target name="build-frontend" depends="init-frontend">
    <exec executable="npm" dir="src/main/frontend">
        <arg value="run"/>
        <arg value="build"/>
    </exec>
</target>

<target name="clean-frontend">
    <delete dir="src/main/frontend/dist"/>
</target>
```

3. Create an ivy.xml file for dependency management. ou can use the provided `ivy.xml` as a reference, but make sure to adjust the dependencies according to your project's needs. Here's a basic example:
```xml
<ivy-module version="2.0">
   <info organisation="com.greglturnquist" module="react-and-spring-data-rest-basic" revision="0.0.1-SNAPSHOT" status="integration" publication="20220226123233"/>
   <configurations>
      <conf name="default" visibility="public"/>
      <conf name="runtime" visibility="public"/>
      <conf name="test" visibility="public"/>
   </configurations>
   <dependencies>
      <dependency org="org.springframework.boot" name="spring-boot-starter-parent" rev="2.2.4.RELEASE" conf="default->default"/>
      <dependency org="org.springframework.boot" name="spring-boot-starter-thymeleaf" rev="2.2.4.RELEASE" conf="default->default"/>
      <dependency org="org.springframework.boot" name="spring-boot-starter-data-jpa" rev="2.2.4.RELEASE" conf="default->default"/>
      <dependency org="org.springframework.boot" name="spring-boot-starter-data-rest" rev="2.2.4.RELEASE" conf="default->default"/>
      <dependency org="org.springframework.boot" name="spring-boot-devtools" rev="2.2.4.RELEASE" conf="default->default"/>
      <dependency org="com.h2database" name="h2" rev="1.4.200" conf="runtime->default"/>
      <dependency org="org.springframework.boot" name="spring-boot-starter-test" rev="2.2.4.RELEASE" conf="test->default"/>
      <dependency org="jakarta.persistence" name="jakarta.persistence-api" rev="3.0.0"/>
      <dependency org="org.junit.jupiter" name="junit-jupiter-api" rev="5.7.0" conf="test->default"/>
      <dependency org="org.springframework" name="spring-context" rev="5.2.3.RELEASE" conf="default->default"/>
      <dependency org="org.springframework" name="spring-webmvc" rev="4.1.6.RELEASE" conf="default->default"/>
      <dependency org="ch.qos.logback" name="logback-classic" rev="1.2.3" conf="default->default"/>
   </dependencies>
</ivy-module>
```

4. Create an `ivysettings.xml` file to specify the repositories Ivy should use to resolve dependencies. Here's a basic example:

```xml
<ivysettings>
    <settings defaultResolver="central"/>
    <caches defaultCacheDir="${user.home}/.ivy2/cache"/>
    <resolvers>
        <ibiblio name="central" m2compatible="true" root="https://repo1.maven.org/maven2"/>
    </resolvers>
</ivysettings>
```

5. Run `ant resolve` to resolve and retrieve dependencies using Ivy.
6. Run `ant clean build` to build the project and generate the frontend code.
7. Start the application. This might involve running a Java command or an Ant task, depending on how your project is set up. In this project is `ant run`
8. Create an Ant task to copy the generated .jar file to a dist folder at the root level of the project.

```xml
<target name="copy-jar" depends="dist" description="copy the .jar file to a dist folder">
    <copy file="${dist}/Part2_ant.jar" todir="${basedir}/dist" overwrite="true"/>
</target>
```

9. Implement an Ant task to delete all files produced by webpack, typically found at src/main/resources/static/built/. This task should be executed automatically by Ant before the clean task.
```xml
   <target name="clean-webpack" description="delete webpack output">
    <delete dir="src/main/resources/static/built"/>
</target>
```

10. Run `ant clean` to clean the project.
11. Finally, if everything is working as expected merge the branch to the main branch using the following command ```git merge --no-ff tut-basic-maven``` and add the *tag ca2-part2*


## Files Explanation
- *build.xml:* This is the build file that Ant uses. It contains targets, which are sets of tasks that Ant should execute. Each task is a piece of code that can be run. Targets can depend on other targets, and Ant ensures that the dependencies are run before the dependent target.
- *ivy.xml:* This file is used by Ivy for dependency management. It lists all the dependencies that your project needs, and Ivy will ensure that these dependencies are available for your project to use.  
- *ivysettings.xml:* This file is used by Ivy to understand where to find the dependencies that your project needs. It lists the repositories that Ivy should use to resolve dependencies.